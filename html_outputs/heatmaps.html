<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>34 Biểu đồ nhiệt | Cẩm nang dịch tễ học với R</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.16/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.0.0/tabwid.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.2.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.52.2/plotly-basic-1.52.2.min.js"></script><script src="libs/plotly-cartesian-1.52.2/plotly-cartesian-1.52.2.min.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-8.1.2/highcharts.js"></script><script src="libs/highcharts-8.1.2/highcharts-3d.js"></script><script src="libs/highcharts-8.1.2/highcharts-more.js"></script><script src="libs/highcharts-8.1.2/modules/stock.js"></script><script src="libs/highcharts-8.1.2/modules/map.js"></script><script src="libs/highcharts-8.1.2/modules/annotations.js"></script><script src="libs/highcharts-8.1.2/modules/data.js"></script><script src="libs/highcharts-8.1.2/modules/drilldown.js"></script><script src="libs/highcharts-8.1.2/modules/item-series.js"></script><script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script><script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-8.1.2/modules/exporting.js"></script><script src="libs/highcharts-8.1.2/modules/export-data.js"></script><script src="libs/highcharts-8.1.2/modules/funnel.js"></script><script src="libs/highcharts-8.1.2/modules/heatmap.js"></script><script src="libs/highcharts-8.1.2/modules/treemap.js"></script><script src="libs/highcharts-8.1.2/modules/sankey.js"></script><script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script><script src="libs/highcharts-8.1.2/modules/organization.js"></script><script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script><script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script><script src="libs/highcharts-8.1.2/modules/sunburst.js"></script><script src="libs/highcharts-8.1.2/modules/vector.js"></script><script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script><script src="libs/highcharts-8.1.2/modules/xrange.js"></script><script src="libs/highcharts-8.1.2/modules/tilemap.js"></script><script src="libs/highcharts-8.1.2/modules/venn.js"></script><script src="libs/highcharts-8.1.2/modules/gantt.js"></script><script src="libs/highcharts-8.1.2/modules/timeline.js"></script><script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script><script src="libs/highcharts-8.1.2/modules/bullet.js"></script><script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script><script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script><script src="libs/highcharts-8.1.2/modules/lollipop.js"></script><script src="libs/highcharts-8.1.2/modules/series-label.js"></script><script src="libs/highcharts-8.1.2/plugins/motion.js"></script><script src="libs/highcharts-8.1.2/custom/reset.js"></script><script src="libs/highcharts-8.1.2/modules/boost.js"></script><script src="libs/highchart-binding-0.8.2/highchart.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-QXDW878QLX"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QXDW878QLX');
    </script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Cẩm nang dịch tễ học với R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">Về cuốn sách này</li>
<li><a class="" href="editorial-style.html"><span class="header-section-number">1</span> Biên tập và ghi chú kỹ thuật</a></li>
<li><a class="" href="data-used.html"><span class="header-section-number">2</span> Tải sách và dữ liệu</a></li>
<li class="book-part">Nhập môn về R</li>
<li><a class="" href="basics.html"><span class="header-section-number">3</span> R Cơ bản</a></li>
<li><a class="" href="transition-to-R.html"><span class="header-section-number">4</span> Chuyển đổi sang R</a></li>
<li><a class="" href="packages-suggested.html"><span class="header-section-number">5</span> Package đề xuất</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> Dự án R</a></li>
<li><a class="" href="importing.html"><span class="header-section-number">7</span> Nhập xuất dữ liệu</a></li>
<li class="book-part">Quản lý dữ liệu</li>
<li><a class="" href="cleaning.html"><span class="header-section-number">8</span> Làm sạch số liệu và các hàm quan trọng</a></li>
<li><a class="" href="dates.html"><span class="header-section-number">9</span> Làm việc với ngày tháng</a></li>
<li><a class="" href="characters-strings.html"><span class="header-section-number">10</span> Ký tự và chuỗi</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">11</span> Factors</a></li>
<li><a class="" href="pivoting.html"><span class="header-section-number">12</span> Xoay trục dữ liệu</a></li>
<li><a class="" href="grouping.html"><span class="header-section-number">13</span> Nhóm dữ liệu</a></li>
<li><a class="" href="joining-matching.html"><span class="header-section-number">14</span> Nối dữ liệu</a></li>
<li><a class="" href="deduplication.html"><span class="header-section-number">15</span> Loại bỏ trùng lặp</a></li>
<li><a class="" href="iteration.html"><span class="header-section-number">16</span> Lặp, vòng lặp, và danh sách</a></li>
<li class="book-part">Phân tích dữ liệu</li>
<li><a class="" href="tables-descriptive.html"><span class="header-section-number">17</span> Bảng mô tả</a></li>
<li><a class="" href="stat-tests.html"><span class="header-section-number">18</span> Các kiểm định thống kê cơ bản</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">19</span> Hồi quy đơn và đa biến</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Dữ liệu Missing</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">21</span> Tỷ suất chuẩn hóa</a></li>
<li><a class="" href="moving-average.html"><span class="header-section-number">22</span> Đường trung bình động</a></li>
<li><a class="" href="time-series.html"><span class="header-section-number">23</span> Chuỗi thời gian và phát hiện ổ dịch</a></li>
<li><a class="" href="epidemic-models.html"><span class="header-section-number">24</span> Mô hình hóa dịch bệnh</a></li>
<li><a class="" href="contact-tracing.html"><span class="header-section-number">25</span> Truy vết tiếp xúc</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">26</span> Phân tích khảo sát</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">27</span> Phân tích sống còn</a></li>
<li><a class="" href="gis.html"><span class="header-section-number">28</span> GIS cơ bản</a></li>
<li class="book-part">Trực quan hóa dữ liệu</li>
<li><a class="" href="tables-presentation.html"><span class="header-section-number">29</span> Trình bày bảng</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">30</span> ggplot cơ bản</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">31</span> Các tips với ggplot</a></li>
<li><a class="" href="epicurves.html"><span class="header-section-number">32</span> Đường cong dịch bệnh</a></li>
<li><a class="" href="age-pyramid.html"><span class="header-section-number">33</span> Tháp dân số và thang đo Likert</a></li>
<li><a class="active" href="heatmaps.html"><span class="header-section-number">34</span> Biểu đồ nhiệt</a></li>
<li><a class="" href="diagrams.html"><span class="header-section-number">35</span> Sơ đồ và biểu đồ</a></li>
<li><a class="" href="combination-analysis.html"><span class="header-section-number">36</span> Biểu đồ kết hợp</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">37</span> Chuỗi lây nhiễm</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">38</span> Cây phả hệ</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">39</span> Biểu đồ tương tác</a></li>
<li class="book-part">Báo cáo và dashboards</li>
<li><a class="" href="rmarkdown.html"><span class="header-section-number">40</span> Báo cáo với R Markdown</a></li>
<li><a class="" href="reportfactory.html"><span class="header-section-number">41</span> Tổ chức báo cáo định kỳ</a></li>
<li><a class="" href="flexdashboard.html"><span class="header-section-number">42</span> Dashboards với R Markdown</a></li>
<li><a class="" href="shiny-basics.html"><span class="header-section-number">43</span> Dashboards với Shiny</a></li>
<li class="book-part">Tổng hợp</li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">44</span> Viết hàm</a></li>
<li><a class="" href="directories.html"><span class="header-section-number">45</span> Tương tác với thư mục làm việc</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">46</span> Version control với Git và Github</a></li>
<li><a class="" href="errors.html"><span class="header-section-number">47</span> Các lỗi thường gặp</a></li>
<li><a class="" href="help.html"><span class="header-section-number">48</span> Nhờ sự trợ giúp</a></li>
<li><a class="" href="network-drives.html"><span class="header-section-number">49</span> R trên ổ cứng mạng</a></li>
<li><a class="" href="data-table.html"><span class="header-section-number">50</span> Data Table</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="heatmaps" class="section level1" number="34">
<h1>
<span class="header-section-number">34</span> Biểu đồ nhiệt<a class="anchor" aria-label="anchor" href="#heatmaps"><i class="fas fa-link"></i></a>
</h1>
<p>Biểu đồ nhiệt, còn được gọi là “bản đồ nhiệt” hoặc “bảng nhiệt”, là những hình ảnh trực quan hữu ích khi cố gắng hiển thị 3 biến (trục x, trục y và màu sắc). Dưới đây chúng tôi minh họa hai ví dụ:</p>
<ul>
<li>Ma trận trực quan về các sự kiện lây truyền theo độ tuổi (“ai lây nhiễm cho ai”)</li>
<li>Theo dõi các chỉ số báo cáo trên nhiều cơ sở/khu vực theo thời gian</li>
</ul>
<p><img src="images/transmission_matrix.png" width="50%"><img src="images/heat_tile.png" width="50%"></p>
<!-- ======================================================= -->
<div id="chuẩn-bị-26" class="section level2" number="34.1">
<h2>
<span class="header-section-number">34.1</span> Chuẩn bị<a class="anchor" aria-label="anchor" href="#chu%E1%BA%A9n-b%E1%BB%8B-26"><i class="fas fa-link"></i></a>
</h2>
<div id="gọi-packages-11" class="section level3 unnumbered">
<h3>Gọi packages<a class="anchor" aria-label="anchor" href="#g%E1%BB%8Di-packages-11"><i class="fas fa-link"></i></a>
</h3>
<p>Đoạn code dưới đây hiển thị cách gọi các packages cần thiết cho việc phân tích dữ liệu. Trong cuốn sách này, chúng tôi nhấn mạnh đến hàm <code><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load()</a></code> từ package <strong>pacman</strong>, cài đặt packages nếu cần <em>và</em> gọi chúng ra để sử dụng. Bạn cũng có thể gọi các packages đã cài đặt với hàm <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> từ <strong>base</strong> R. Xem chương <a href="basics.html#basics">R cơ bản</a> để biết thêm thông tin về các packages trong R.</p>
<div class="sourceCode" id="cb1619"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span>
  <span class="va">tidyverse</span>,       <span class="co"># data manipulation and visualization</span>
  <span class="va">rio</span>,             <span class="co"># importing data </span>
  <span class="va">lubridate</span>        <span class="co"># working with dates</span>
  <span class="op">)</span></code></pre></div>
<p><strong>Bộ dữ liệu</strong></p>
<p>Chương này sẽ sử dụng bộ dữ liệu linelist-một vụ dịch mô phỏng trong mục ma trận lây truyền và bộ dữ liệu về số trường hợp sốt rét được ghi nhận hàng ngày theo cơ sở trong phần theo dõi các chỉ số báo cáo. Các bộ dữ liệu sẽ được gọi và làm sạch trong khi trình bày.</p>
</div>
</div>
<div id="ma-trận-lây-truyền-1" class="section level2" number="34.2">
<h2>
<span class="header-section-number">34.2</span> Ma trận lây truyền<a class="anchor" aria-label="anchor" href="#ma-tr%E1%BA%ADn-l%C3%A2y-truy%E1%BB%81n-1"><i class="fas fa-link"></i></a>
</h2>
<p>Bảng nhiệt có thể hữu ích để trực quan hóa ma trận. Một ví dụ là hiển thị “ai đã lây nhiễm cho ai” trong một vụ dịch. Giả sử rằng bạn có đầy đủ thông tin về các sự kiện lây truyền.</p>
<p>Lưu ý rằng chương <a href="contact-tracing.html#contact-tracing">Truy vết tiếp xúc</a> có một ví dụ khác về tạo ma trận tiếp xúc thành bảng nhiệt, sử dụng một dataset khác (có lẽ đơn giản hơn) trong đó tuổi của các trường hợp và nguồn lây của chúng được căn chỉnh gọn gàng trên cùng một hàng của data frame. Dataset này cũng được sử dụng để tạo bản đồ <em>mật độ</em> trong chương <a href="ggplot-tips.html#ggplot-tips">Các tips với ggplot</a>. Ví dụ dưới đây bắt đầu từ một danh sách các trường hợp và yêu cầu nhiều thao tác biến đổi dữ liệu trước khi thành một data frame sẵn sàng để vẽ biểu đồ. Vì vậy, có rất nhiều kịch bản để bạn lựa chọn…</p>
<p>Chúng tôi bắt đầu từ danh sách trường hợp của một vụ dịch Ebola mô phỏng. Nếu bạn muốn theo dõi, hãy <a href="https://github.com/appliedepi/epirhandbook_eng/raw/master/data/case_linelists/linelist_cleaned.rds" class="download-button">bấm để tải bộ dữ liệu linelist “đã làm sạch”</a> (as .rds file). Nhập dữ liệu của bạn bằng hàm <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> từ package <strong>rio</strong> (hàm này chấp nhận nhiều loại tệp như .xlsx, .rds, .csv - Xem chương <a href="importing.html#importing">Nhập xuất dữ liệu</a> để biết thêm chi tiết).</p>
<p>Danh sách dưới đây bao gồm 50 hàng đầu tiên của linelist:</p>
<div class="sourceCode" id="cb1620"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_cleaned.rds"</span><span class="op">)</span></code></pre></div>
<p>Trong bộ dữ liệu linelist này:</p>
<ul>
<li>Mỗi trường hợp được thể hiện trên một hàng, được định danh bằng <code>case_id</code><br>
</li>
<li>Kéo sang phải bạn sẽ thấy cột <code>infector</code> có chứa <code>case_id</code> của <em>nguồn lây</em>, mỗi nguồn lây cũng là một trường hợp trong linelist</li>
</ul>
<div id="htmlwidget-5ccc3f4f0bc6ccf3db78" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5ccc3f4f0bc6ccf3db78">{"x":{"filter":"none","data":[["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca","2978ac","57a565","fc15ef","2eaa9a","bbfa93","c97dd9","f50e8a","3a7673","7f5a01","ddddee","99e8fa","567136","9371a9","bc2adf","403057","8bd1e8","f327be","42e1a9","90e5fe","959170","8ebf6e","e56412","6d788e","a47529","67be4e","da8ecb","148f18","2cb9a5","f5c142","70a9fe","3ad520","062638","c76676","baacc1","497372","23e499","38cc4a","3789ee","c71dcd","6b70f0"],[4,4,2,3,3,3,4,4,4,4,4,4,6,5,6,9,10,8,7,6,7,6,8,6,10,8,6,12,5,8,7,9,11,5,8,5,6,11,7,9,7,8,9,12,13,9,8,10,8,7],["2014-05-08",null,null,"2014-05-04","2014-05-18","2014-05-03","2014-05-22","2014-05-28",null,null,"2014-05-30","2014-05-28","2014-06-14","2014-06-07","2014-06-09",null,null,null,"2014-06-23","2014-06-18","2014-06-24",null,null,"2014-07-03",null,"2014-07-10","2014-06-14",null,"2014-06-18","2014-06-29","2014-07-02","2014-07-12","2014-07-12","2014-06-13","2014-07-15","2014-06-20",null,null,"2014-07-20",null,"2014-07-12","2014-07-19","2014-07-18","2014-07-18","2014-07-27",null,"2014-07-19","2014-07-26","2014-07-24",null],["2014-05-13","2014-05-13","2014-05-16","2014-05-18","2014-05-21","2014-05-22","2014-05-27","2014-06-02","2014-06-05","2014-06-05","2014-06-06","2014-06-13","2014-06-16","2014-06-17","2014-06-18","2014-06-19","2014-06-22","2014-06-23","2014-06-25","2014-06-26","2014-06-28","2014-07-02","2014-07-08","2014-07-09","2014-07-09","2014-07-10","2014-07-12","2014-07-12","2014-07-13","2014-07-13","2014-07-14","2014-07-15","2014-07-16","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-22","2014-07-22","2014-07-24","2014-07-24","2014-07-25","2014-07-25","2014-07-27","2014-07-29","2014-07-30",null,"2014-08-01","2014-08-02","2014-08-03"],["2014-05-15","2014-05-14","2014-05-18","2014-05-20","2014-05-22","2014-05-23","2014-05-29","2014-06-03","2014-06-06","2014-06-07","2014-06-08","2014-06-15","2014-06-17","2014-06-17","2014-06-20","2014-06-19","2014-06-23","2014-06-24","2014-06-27","2014-06-28","2014-06-29","2014-07-03","2014-07-09","2014-07-09","2014-07-11","2014-07-11","2014-07-13","2014-07-14","2014-07-14","2014-07-13","2014-07-14","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-20","2014-07-20","2014-07-22","2014-07-24","2014-07-26","2014-07-24","2014-07-27","2014-07-25","2014-07-27","2014-07-31","2014-08-01","2014-08-03","2014-08-02","2014-08-02","2014-08-04"],[null,"2014-05-18","2014-05-30",null,"2014-05-29","2014-05-24","2014-06-01","2014-06-07","2014-06-18","2014-06-09","2014-06-15",null,"2014-07-09",null,"2014-06-30","2014-07-11","2014-07-01","2014-06-25","2014-07-06","2014-07-02","2014-07-09","2014-07-07","2014-07-20",null,"2014-07-22","2014-07-16","2014-07-14","2014-07-20","2014-07-16","2014-07-19","2014-07-27","2014-07-19",null,"2014-07-26","2014-08-14","2014-08-01","2014-07-23","2014-08-28","2014-07-28","2014-07-19",null,"2014-08-03",null,null,null,"2014-08-06","2014-08-21","2014-09-13","2014-08-04",null],[null,"Recover","Recover",null,"Recover","Recover","Recover","Death","Recover","Death","Death","Death","Recover","Recover",null,"Recover",null,null,"Death","Death","Recover",null,null,null,"Death",null,"Death","Death",null,"Death","Recover","Death","Recover","Death","Recover",null,"Death","Recover","Recover","Death",null,null,"Death","Death","Death","Death","Recover",null,"Death","Death"],["m","f","m","f","m","f","f","f","m","f","m","m","m","f","f","m","f","f","f","f","m","m","f","m","f","m","m","f","m","f","f","f","m","m","f","m","f","f","f","m","f","m","f","m","m","f","m","f","m","m"],[2,3,56,18,3,16,16,0,61,27,12,42,19,7,7,13,35,17,11,11,19,54,14,28,6,3,31,6,67,14,10,21,20,45,1,12,3,15,20,36,7,13,14,3,10,1,0,20,26,14],["years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years"],[2,3,56,18,3,16,16,0,61,27,12,42,19,7,7,13,35,17,11,11,19,54,14,28,6,3,31,6,67,14,10,21,20,45,1,12,3,15,20,36,7,13,14,3,10,1,0,20,26,14],["0-4","0-4","50-69","15-19","0-4","15-19","15-19","0-4","50-69","20-29","10-14","30-49","15-19","5-9","5-9","10-14","30-49","15-19","10-14","10-14","15-19","50-69","10-14","20-29","5-9","0-4","30-49","5-9","50-69","10-14","10-14","20-29","20-29","30-49","0-4","10-14","0-4","15-19","20-29","30-49","5-9","10-14","10-14","0-4","10-14","0-4","0-4","20-29","20-29","10-14"],["0-4","0-4","55-59","15-19","0-4","15-19","15-19","0-4","60-64","25-29","10-14","40-44","15-19","5-9","5-9","10-14","35-39","15-19","10-14","10-14","15-19","50-54","10-14","25-29","5-9","0-4","30-34","5-9","65-69","10-14","10-14","20-24","20-24","45-49","0-4","10-14","0-4","15-19","20-24","35-39","5-9","10-14","10-14","0-4","10-14","0-4","0-4","20-24","25-29","10-14"],["Other","Missing","St. Mark's Maternity Hospital (SMMH)","Port Hospital","Military Hospital","Port Hospital","Missing","Missing","Missing","Missing","Port Hospital","Military Hospital","Missing","Missing","Other","Port Hospital","Port Hospital","Port Hospital","Missing","Other","Port Hospital","Port Hospital","St. Mark's Maternity Hospital (SMMH)","Missing","Other","Missing","St. Mark's Maternity Hospital (SMMH)","Military Hospital","Port Hospital","Central Hospital","Military Hospital","Central Hospital","Missing","Military Hospital","Other","Missing","Missing","Port Hospital","Port Hospital","Port Hospital","Missing","Central Hospital","Military Hospital","Other","Other","Other","Missing","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","Missing"],[-13.2157351064963,-13.2152339775486,-13.212910703914,-13.2363711169728,-13.2228638912441,-13.222625321098,-13.2331547837254,-13.2320975453153,-13.2225511595637,-13.2572163655863,-13.2206286746001,-13.253989309478,-13.2385127873491,-13.209391925612,-13.2157278814899,-13.2243437095992,-13.2336087079551,-13.21422143145,-13.2339681355349,-13.2535640411465,-13.2250089377786,-13.2160657166043,-13.2680671272333,-13.2266742923612,-13.2160179088168,-13.2482584611565,-13.2156319199566,-13.2142410663192,-13.2614879104088,-13.2452992638476,-13.2630592726116,-13.2343341712241,-13.2199077448676,-13.2227293309912,-13.2343062806506,-13.218781651651,-13.2483677722899,-13.2097478342339,-13.2680867723786,-13.2587535457526,-13.262635786914,-13.2697246824573,-13.2209026809759,-13.2330734719715,-13.2680923666905,-13.2547212675054,-13.2573683214693,-13.2137356012883,-13.2175973322257,-13.2486407324245],[8.46897295100924,8.45171855856465,8.46481700596819,8.4754761613651,8.46082377490923,8.46183062600728,8.46272931462646,8.46144367534271,8.46191259217774,8.47292327643506,8.48401630165138,8.45837125340844,8.47761705512509,8.47570184950483,8.47779946878972,8.47145134147474,8.47804840685363,8.48528034195779,8.46957530395867,8.45957352078114,8.47404889511544,8.48802917129884,8.473437335922,8.48408263734462,8.46242233645879,8.47026822126572,8.46398447480533,8.4641347894342,8.45623094629607,8.48334624336805,8.47493999153642,8.47832062438022,8.4693933891765,8.48480589906514,8.47121232619015,8.48438437371817,8.48466158574339,8.47714159984428,8.46238127010609,8.45568597813113,8.4632880274758,8.47940722413856,8.46353857052336,8.46178968158864,8.47508713872833,8.45825808128071,8.4532568143863,8.4732571907655,8.47911586641933,8.48480340615605],["f547d6",null,null,"f90f5f","11f8ea","aec8ec","893f25","133ee7",null,null,"996f3a","133ee7","37a6f6","9f6884","4802b1",null,null,null,"a75c7f","8e104d","ab634e",null,null,"b799eb",null,"5d9e4d","a15e13",null,"ea3740","beb26e","567136","894024","36e2e7","a2086d","7baf73","eb2277",null,null,"d6584f",null,"312ecf","52ea64","cfd79c","d145b7","174288",null,"53608c","3b096b","f5c142",null],["other",null,null,"other","other","other","other","other",null,null,"other","other","other","other","other",null,null,null,"other","other","other",null,null,"other",null,"other","other",null,"other","funeral","other","funeral","other","other","other","funeral",null,null,"other",null,"other","other","other","other","other",null,"funeral","other","other",null],[27,25,91,41,36,56,47,0,86,69,67,84,68,44,34,66,78,47,53,47,71,86,53,69,38,46,68,37,100,56,50,57,65,72,29,69,37,48,54,71,47,61,47,35,53,16,13,59,69,67],[48,59,238,135,71,116,87,11,226,174,112,186,174,90,91,152,214,137,117,131,150,241,131,161,80,69,188,66,233,142,110,182,164,214,26,157,39,154,133,168,100,125,123,67,134,31,36,125,183,169],[22,22,21,23,23,21,21,22,22,22,22,22,22,21,23,22,23,21,22,23,21,23,21,24,23,22,24,23,20,24,24,20,24,21,22,21,23,22,23,23,23,22,23,22,22,22,23,22,22,22],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","no","no","no",null,"no","no","no","no","no",null,"no","no","no",null,null,"no","no",null,"no","no",null,null,"no","no",null,"no","no",null,"no","no","no","no","no","no",null],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","no","yes","no",null,"no","no","no","yes","no",null,"no","no","yes",null,null,"no","no",null,"no","no",null,null,"no","no",null,"no","no",null,"no","yes","no","no","no","no",null],["yes",null,null,"no","yes","yes",null,"yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes",null,"yes","yes","yes","yes","yes",null,"yes","yes","yes",null,null,"yes","yes",null,"yes","yes",null,null,"yes","yes",null,"yes","yes",null,"yes","yes","yes","yes","yes","no",null],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","yes","no","no",null,"no","no","no","no","no",null,"no","no","no",null,null,"no","no",null,"no","no",null,null,"yes","yes",null,"no","no",null,"no","no","no","no","no","no",null],["yes",null,null,"no","yes","yes",null,"yes","yes","no","yes","no","no","no","yes","no","no","no",null,"no","yes","no","no","no",null,"no","no","no",null,null,"no","yes",null,"yes","yes",null,null,"yes","yes",null,"yes","yes",null,"yes","yes","no","yes","yes","yes",null],[36.8,36.9,36.9,36.8,36.9,37.6,37.3,37,36.4,35.9,36.5,36.9,36.5,37.1,36.5,37.3,37,38,38,36,37,36.7,36.9,36.5,37,36.5,37.6,36.6,36.6,36.2,36.4,37.1,37.5,37.5,37.4,36.9,36.4,37.3,37,37.8,36.5,37.5,36.7,37,37.3,36.6,36.5,36.6,37.6,36.8],[null,"09:36","16:48","11:22","12:60","14:13","14:33","09:25","11:16","10:55","16:03","11:14","12:42","11:06","09:10","08:45",null,"15:41","13:34","18:58","12:43","16:33","14:29","07:18","08:11","16:32","16:17","07:32","17:45",null,"13:24","14:43","02:33","11:36","17:28","16:27",null,"20:49",null,"11:38","14:25","13:42","21:22","13:33","19:06","17:14","20:09",null,"10:23","09:09"],[117.1875,71.8184429761563,16.0652496292635,22.4965706447188,71.4144019043841,41.6171224732461,62.0953890870657,0,16.8376536925366,22.7903289734443,53.4119897959184,24.2802636142907,22.4600343506408,54.320987654321,41.0578432556455,28.5664819944598,17.0320552013276,25.0412914912888,38.7172182043977,27.3876813705495,31.5555555555556,14.8069075945662,30.8839811199813,26.6193433895297,59.375,96.6183574879227,19.2394748755093,84.9403122130395,18.4199377406104,27.7722674072605,41.3223140495868,17.2080666586161,24.1671624033314,15.7218971089178,428.994082840237,27.9930220292912,243.261012491782,20.2395007589813,30.527446435638,25.15589569161,47,39.04,31.0661643201798,77.9683671196257,29.5165961238583,166.493236212279,100.308641975309,37.76,20.6037803457852,23.458562375267],[2,1,2,2,1,1,2,1,1,2,2,2,1,0,2,0,1,1,2,2,1,1,1,0,2,1,1,2,1,0,0,2,1,1,2,2,1,0,2,2,0,2,0,0,2,2,null,1,0,1]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,8,10,14,15,18,19,20,26,28,29]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><div id="chuẩn-bị-dữ-liệu" class="section level3 unnumbered">
<h3>Chuẩn bị dữ liệu<a class="anchor" aria-label="anchor" href="#chu%E1%BA%A9n-b%E1%BB%8B-d%E1%BB%AF-li%E1%BB%87u"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Mục tiêu</strong>: Chúng ta cần tạo một data frame dạng “dọc”, tức là mỗi đường lây truyền theo lứa tuổi có thể có nằm trên một hàng, với một cột số chứa tỷ lệ của hàng đó đối với tất cả các sự kiện lây nhiễm được quan sát trong linelist.</p>
<p>Để đạt được mục tiêu này, một số bước biến đổi dữ liệu cần được thực hiện:</p>
<div id="tạo-data-frame-các-trường-hợp" class="section level4 unnumbered">
<h4>Tạo data frame các trường hợp<a class="anchor" aria-label="anchor" href="#t%E1%BA%A1o-data-frame-c%C3%A1c-tr%C6%B0%E1%BB%9Dng-h%E1%BB%A3p"><i class="fas fa-link"></i></a>
</h4>
<p>Để bắt đầu, chúng ta tạo một data frame về các trường hợp, bao gồm độ tuổi và nguồn lây nhiễm của chúng - chúng ta đặt tên data frame này là <code>case_ages</code>. 50 hàng đầu tiên của bộ dữ liệu dữ liệu được hiển thị bên dưới.</p>
<div class="sourceCode" id="cb1621"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">case_ages</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">case_id</span>, <span class="va">infector</span>, <span class="va">age_cat</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">rename</span><span class="op">(</span><span class="st">"case_age_cat"</span> <span class="op">=</span> <span class="st">"age_cat"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-9d9af7ec41571c395fc6" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9d9af7ec41571c395fc6">{"x":{"filter":"none","data":[["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca","2978ac","57a565","fc15ef","2eaa9a","bbfa93","c97dd9","f50e8a","3a7673","7f5a01","ddddee","99e8fa","567136","9371a9","bc2adf","403057","8bd1e8","f327be","42e1a9","90e5fe","959170","8ebf6e","e56412","6d788e","a47529","67be4e","da8ecb","148f18","2cb9a5","f5c142","70a9fe","3ad520","062638","c76676","baacc1","497372","23e499","38cc4a","3789ee","c71dcd","6b70f0"],["f547d6",null,null,"f90f5f","11f8ea","aec8ec","893f25","133ee7",null,null,"996f3a","133ee7","37a6f6","9f6884","4802b1",null,null,null,"a75c7f","8e104d","ab634e",null,null,"b799eb",null,"5d9e4d","a15e13",null,"ea3740","beb26e","567136","894024","36e2e7","a2086d","7baf73","eb2277",null,null,"d6584f",null,"312ecf","52ea64","cfd79c","d145b7","174288",null,"53608c","3b096b","f5c142",null],["0-4","0-4","50-69","15-19","0-4","15-19","15-19","0-4","50-69","20-29","10-14","30-49","15-19","5-9","5-9","10-14","30-49","15-19","10-14","10-14","15-19","50-69","10-14","20-29","5-9","0-4","30-49","5-9","50-69","10-14","10-14","20-29","20-29","30-49","0-4","10-14","0-4","15-19","20-29","30-49","5-9","10-14","10-14","0-4","10-14","0-4","0-4","20-29","20-29","10-14"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>infector<\/th>\n      <th>case_age_cat<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="tạo-data-frame-nguồn-lây-nhiễm" class="section level4 unnumbered">
<h4>Tạo data frame nguồn lây nhiễm<a class="anchor" aria-label="anchor" href="#t%E1%BA%A1o-data-frame-ngu%E1%BB%93n-l%C3%A2y-nhi%E1%BB%85m"><i class="fas fa-link"></i></a>
</h4>
<p>Tiếp theo, chúng ta tạo một data frame các nguồn lây nhiễm - tại thời điểm này, nó chỉ gồm một cột duy nhất. Đây là các ID của các nguồn lâu nhiễm trong bộ dữ liệu linelist. Không phải mọi trường hợp đều xác định được nguồn lây, vì vậy chúng ta cần loại bỏ các giá trị missing. 50 hàng đầu tiên được hiển thị bên dưới.</p>
<div class="sourceCode" id="cb1622"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">infectors</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">infector</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">drop_na</span><span class="op">(</span><span class="va">infector</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-83fde044a398a5c131a3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-83fde044a398a5c131a3">{"x":{"filter":"none","data":[["f547d6","f90f5f","11f8ea","aec8ec","893f25","133ee7","996f3a","133ee7","37a6f6","9f6884","4802b1","a75c7f","8e104d","ab634e","b799eb","5d9e4d","a15e13","ea3740","beb26e","567136","894024","36e2e7","a2086d","7baf73","eb2277","d6584f","312ecf","52ea64","cfd79c","d145b7","174288","53608c","3b096b","f5c142","d05405","700448","a2e5cc","7fd086","4e08f2","3789ee","c2595d","b7641e","ce4ec6","09f7ab","4b501e","006775","1f8797","2b36fa","068c6a","535760"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>infector<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Tiếp theo, chúng ta sử dụng hàm join để thu thập tuổi của những nguồn lây nhiễm. Điều này không đơn giản, vì trong <code>linelist</code>, tuổi của người lây nhiễm không được liệt kê như vậy. Chúng ta sẽ đạt được kết quả này bằng cách nối dữ liệu các trường hợp trong <code>linelist</code> với dữ liệu những người lây nhiễm. Chúng ta bắt đầu với bộ dữ liệu infectors, sau đó dùng hàm <code>left_join()</code> thêm các trường hợp trong <code>linelist</code> sao cho cột id của các trường hợp lây nhiễm trong bộ dữ liệu <code>infector</code> nối với cột <code>case_id</code> trong bộ dữ liệu <code>linelist</code>.</p>
<p>Do đó, dữ liệu từ bản ghi trường hợp của người lây nhiễm trong linelist (bao gồm cả tuổi) được thêm vào hàng của người lây nhiễm. 50 hàng đầu tiên được hiển thị bên dưới.</p>
<div class="sourceCode" id="cb1623"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">infector_ages</span> <span class="op">&lt;-</span> <span class="va">infectors</span> <span class="op">%&gt;%</span>             <span class="co"># begin with infectors</span>
  <span class="fu">left_join</span><span class="op">(</span>                               <span class="co"># add the linelist data to each infector  </span>
    <span class="va">linelist</span>,
    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"infector"</span> <span class="op">=</span> <span class="st">"case_id"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>    <span class="co"># match infector to their information as a case</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">infector</span>, <span class="va">age_cat</span><span class="op">)</span> <span class="op">%&gt;%</span>            <span class="co"># keep only columns of interest</span>
  <span class="fu">rename</span><span class="op">(</span><span class="st">"infector_age_cat"</span> <span class="op">=</span> <span class="st">"age_cat"</span><span class="op">)</span>   <span class="co"># rename for clarity</span></code></pre></div>
<div id="htmlwidget-84ef44b1d27b971dcf92" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-84ef44b1d27b971dcf92">{"x":{"filter":"none","data":[["f547d6","f90f5f","11f8ea","aec8ec","893f25","133ee7","996f3a","133ee7","37a6f6","9f6884","4802b1","a75c7f","8e104d","ab634e","b799eb","5d9e4d","a15e13","ea3740","beb26e","567136","894024","36e2e7","a2086d","7baf73","eb2277","d6584f","312ecf","52ea64","cfd79c","d145b7","174288","53608c","3b096b","f5c142","d05405","700448","a2e5cc","7fd086","4e08f2","3789ee","c2595d","b7641e","ce4ec6","09f7ab","4b501e","006775","1f8797","2b36fa","068c6a","535760"],["15-19",null,"50-69",null,"0-4","20-29",null,"20-29",null,"15-19",null,null,"10-14",null,"10-14",null,null,null,null,"50-69",null,null,null,null,null,"5-9",null,"10-14","10-14","0-4","20-29",null,null,"20-29",null,"5-9",null,"10-14",null,"20-29","10-14","5-9","0-4",null,null,null,"5-9","15-19",null,null]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>infector<\/th>\n      <th>infector_age_cat<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Sau đó, chúng ta kết hợp các trường hợp và tuổi của chúng với những người lây nhiễm và tuổi của những người này lại. Mỗi data frame đều có chung cột <code>infector</code>, vì vậy nó được sử dụng cho phép nối. Các hàng đầu tiên được hiển thị bên dưới:</p>
<div class="sourceCode" id="cb1624"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ages_complete</span> <span class="op">&lt;-</span> <span class="va">case_ages</span> <span class="op">%&gt;%</span>  
  <span class="fu">left_join</span><span class="op">(</span>
    <span class="va">infector_ages</span>,
    by <span class="op">=</span> <span class="st">"infector"</span><span class="op">)</span> <span class="op">%&gt;%</span>        <span class="co"># each has the column infector</span>
  <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span>                     <span class="co"># drop rows with any missing data</span></code></pre></div>
<div id="htmlwidget-a95124ec0cb3f6471b85" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a95124ec0cb3f6471b85">{"x":{"filter":"none","data":[["5fe599","5fe599","5fe599","893f25","893f25","893f25","893f25","893f25","07e3e8","369449","369449","57a565","57a565","2eaa9a","ddddee","bc2adf","bc2adf","8ebf6e","f5c142","062638","c76676","c76676","c76676","baacc1","497372","c71dcd","c71dcd","422831","2b36fa","2b36fa","2b36fa","4ade58","9f0c37","f97626","7d99f2","7d99f2","babc2d","d5f3c0","d5f3c0","8b4b24","bd5a25","564652","564652","890de4","890de4","890de4","890de4","cc71ea","cc71ea","3c0ca7"],["f547d6","f547d6","f547d6","11f8ea","11f8ea","11f8ea","11f8ea","11f8ea","893f25","133ee7","133ee7","133ee7","133ee7","9f6884","8e104d","b799eb","b799eb","567136","d6584f","52ea64","cfd79c","cfd79c","cfd79c","d145b7","174288","f5c142","f5c142","700448","7fd086","7fd086","7fd086","3789ee","c2595d","b7641e","ce4ec6","ce4ec6","1f8797","2b36fa","2b36fa","108b95","5b2dd9","92e129","92e129","9a9a84","9a9a84","9a9a84","9a9a84","68623f","68623f","088b66"],["0-4","0-4","0-4","0-4","0-4","0-4","0-4","0-4","15-19","0-4","0-4","30-49","30-49","5-9","10-14","20-29","20-29","10-14","20-29","10-14","10-14","10-14","10-14","0-4","10-14","20-29","20-29","10-14","15-19","15-19","15-19","30-49","10-14","5-9","5-9","5-9","20-29","5-9","5-9","15-19","20-29","15-19","15-19","30-49","30-49","30-49","30-49","30-49","30-49","5-9"],["15-19","15-19","15-19","50-69","50-69","50-69","50-69","50-69","0-4","20-29","20-29","20-29","20-29","15-19","10-14","10-14","10-14","50-69","5-9","10-14","10-14","10-14","10-14","0-4","20-29","20-29","20-29","5-9","10-14","10-14","10-14","20-29","10-14","5-9","0-4","0-4","5-9","15-19","15-19","15-19","30-49","10-14","10-14","70+","70+","70+","70+","30-49","30-49","30-49"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>infector<\/th>\n      <th>case_age_cat<\/th>\n      <th>infector_age_cat<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Dưới đây là bảng chéo đơn giản về số lượng các trường hợp và người lây nhiễm theo nhóm tuổi. Nhãn được thêm vào để phân biệt.</p>
<div class="sourceCode" id="cb1625"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="va">ages_complete</span><span class="op">$</span><span class="va">case_age_cat</span>,
      infectors <span class="op">=</span> <span class="va">ages_complete</span><span class="op">$</span><span class="va">infector_age_cat</span><span class="op">)</span></code></pre></div>
<pre><code>##        infectors
## cases   0-4 5-9 10-14 15-19 20-29 30-49 50-69 70+
##   0-4   105 156   105   114   143   117    13   0
##   5-9   102 132   110   102   117    96    12   5
##   10-14 104 109    91    79   120    80    12   4
##   15-19  85 105    82    39    75    69     7   5
##   20-29 101 127   109    80   143   107    22   4
##   30-49  72  97    56    54    98    61     4   5
##   50-69   5   6    15     9     7     5     2   0
##   70+     1   0     2     0     0     0     0   0</code></pre>
<p>Chúng ta có thể chuyển đổi bảng này thành data frame với hàm <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> từ <strong>base</strong> R, hàm sẽ tự động chuyển đổi dữ liệu sang dạng “dọc” để có thể áp dụng trong hàm <code>ggplot()</code>. Các hàng đầu tiên được hiển thị bên dưới.</p>
<div class="sourceCode" id="cb1627"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">long_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>
    cases     <span class="op">=</span> <span class="va">ages_complete</span><span class="op">$</span><span class="va">case_age_cat</span>,
    infectors <span class="op">=</span> <span class="va">ages_complete</span><span class="op">$</span><span class="va">infector_age_cat</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-0237e2294769cc69edff" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0237e2294769cc69edff">{"x":{"filter":"none","data":[["0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9"],["0-4","0-4","0-4","0-4","0-4","0-4","0-4","0-4","5-9","5-9","5-9","5-9","5-9","5-9","5-9","5-9","10-14","10-14","10-14","10-14","10-14","10-14","10-14","10-14","15-19","15-19","15-19","15-19","15-19","15-19","15-19","15-19","20-29","20-29","20-29","20-29","20-29","20-29","20-29","20-29","30-49","30-49","30-49","30-49","30-49","30-49","30-49","30-49","50-69","50-69"],[105,102,104,85,101,72,5,1,156,132,109,105,127,97,6,0,105,110,91,82,109,56,15,2,114,102,79,39,80,54,9,0,143,117,120,75,143,98,7,0,117,96,80,69,107,61,5,0,13,12]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>cases<\/th>\n      <th>infectors<\/th>\n      <th>Freq<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Bây giờ chúng ta làm tương tự, nhưng áp dụng hàm <code><a href="https://rdrr.io/r/base/proportions.html">prop.table()</a></code> từ <strong>base</strong> R vào bảng để thay vì nhận số lượng, chúng ta nhận được tỷ lệ của tất cả các biến. 50 hàng đầu tiên được hiển thị bên dưới.</p>
<div class="sourceCode" id="cb1628"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">long_prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>
    cases <span class="op">=</span> <span class="va">ages_complete</span><span class="op">$</span><span class="va">case_age_cat</span>,
    infectors <span class="op">=</span> <span class="va">ages_complete</span><span class="op">$</span><span class="va">infector_age_cat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-089ecd1fa6eb02eaa5fa" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-089ecd1fa6eb02eaa5fa">{"x":{"filter":"none","data":[["0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+","0-4","5-9"],["0-4","0-4","0-4","0-4","0-4","0-4","0-4","0-4","5-9","5-9","5-9","5-9","5-9","5-9","5-9","5-9","10-14","10-14","10-14","10-14","10-14","10-14","10-14","10-14","15-19","15-19","15-19","15-19","15-19","15-19","15-19","15-19","20-29","20-29","20-29","20-29","20-29","20-29","20-29","20-29","30-49","30-49","30-49","30-49","30-49","30-49","30-49","30-49","50-69","50-69"],[0.0284784377542718,0.0276647681041497,0.0282072145375644,0.0230539734201248,0.0273935448874424,0.0195280716029292,0.00135611608353675,0.00027122321670735,0.0423108218063466,0.0358014646053702,0.0295633306211012,0.0284784377542718,0.0344453485218335,0.026308652020613,0.0016273393002441,0,0.0284784377542718,0.0298345538378085,0.0246813127203689,0.0222403037700027,0.0295633306211012,0.0151885001356116,0.00406834825061025,0.0005424464334147,0.0309194467046379,0.0276647681041497,0.0214266341198807,0.0105777054515867,0.021697857336588,0.0146460537021969,0.00244100895036615,0,0.0387849199891511,0.03173311635476,0.032546786004882,0.0203417412530513,0.0387849199891511,0.0265798752373203,0.00189856251695145,0,0.03173311635476,0.0260374288039056,0.021697857336588,0.0187144019528072,0.0290208841876865,0.0165446162191484,0.00135611608353675,0,0.00352590181719555,0.0032546786004882]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>cases<\/th>\n      <th>infectors<\/th>\n      <th>Freq<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="tạo-biểu-đồ-nhiệt" class="section level3 unnumbered">
<h3>Tạo biểu đồ nhiệt<a class="anchor" aria-label="anchor" href="#t%E1%BA%A1o-bi%E1%BB%83u-%C4%91%E1%BB%93-nhi%E1%BB%87t"><i class="fas fa-link"></i></a>
</h3>
<p>Cuối cùng, chúng ta có thể vẽ biểu đồ nhiệt với hàm <code>geom_tile()</code> trong package <strong>ggplot2</strong>. Xem chương <a href="ggplot-tips.html#ggplot-tips">Các tips với ggplot</a> để tìm hiểu sâu hơn về thang màu/tô màu cho biểu đồ, đặc biệt là hàm <code>scale_fill_gradient()</code>.</p>
<ul>
<li>Bên trong hàm <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> của hàm <code>geom_tile()</code>, thiết lập trục x và y tương ứng với tuổi của các trường hợp và tuổi của người lây nhiễm<br>
</li>
<li>Ngoài ra trong hàm <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, hãy đặt đối số <code>fill =</code> tới cột tần suất <code>Freq</code> - đây là giá trị sẽ được chuyển đổi thành màu gạch</li>
<li>Đặt màu thang đo với <code>scale_fill_gradient()</code> - bạn có thể chỉ định màu cao/thấp
<ul>
<li>Lưu ý rằng <code>scale_color_gradient()</code> là một cái khác! Trong trường hợp này, bạn sẽ sử dụng fill</li>
</ul>
</li>
<li>Bởi vì màu được tạo thông qua “fill”, bạn có thể sử dụng đối số <code>fill =</code> đối số trong hàm <code>labs()</code> để thay đổi tiêu đề chú giải</li>
</ul>
<div class="sourceCode" id="cb1629"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">long_prop</span><span class="op">)</span><span class="op">+</span>       <span class="co"># use long data, with proportions as Freq</span>
  <span class="fu">geom_tile</span><span class="op">(</span>                    <span class="co"># visualize it in tiles</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">cases</span>,         <span class="co"># x-axis is case age</span>
      y <span class="op">=</span> <span class="va">infectors</span>,     <span class="co"># y-axis is infector age</span>
      fill <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>            <span class="co"># color of the tile is the Freq column in the data</span>
  <span class="fu">scale_fill_gradient</span><span class="op">(</span>          <span class="co"># adjust the fill color of the tiles</span>
    low <span class="op">=</span> <span class="st">"blue"</span>,
    high <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>                         <span class="co"># labels</span>
    x <span class="op">=</span> <span class="st">"Case age"</span>,
    y <span class="op">=</span> <span class="st">"Infector age"</span>,
    title <span class="op">=</span> <span class="st">"Who infected whom"</span>,
    subtitle <span class="op">=</span> <span class="st">"Frequency matrix of transmission events"</span>,
    fill <span class="op">=</span> <span class="st">"Proportion of all\ntranmsission events"</span>     <span class="co"># legend title</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-1244-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="các-chỉ-số-báo-cáo-theo-thời-gian" class="section level2" number="34.3">
<h2>
<span class="header-section-number">34.3</span> Các chỉ số báo cáo theo thời gian<a class="anchor" aria-label="anchor" href="#c%C3%A1c-ch%E1%BB%89-s%E1%BB%91-b%C3%A1o-c%C3%A1o-theo-th%E1%BB%9Di-gian"><i class="fas fa-link"></i></a>
</h2>
<p>Thông thường, trong lĩnh vực y tế công cộng, một mục tiêu là đánh giá xu hướng theo thời gian của nhiều thực thể (cơ sở, khu vực pháp lý, v.v.). Một cách để hình dung các xu hướng như vậy theo thời gian là biểu đồ nhiệt trong đó trục x là thời gian và trên trục y là các thực thể.</p>
<div id="chuẩn-bị-dữ-liệu-1" class="section level3 unnumbered">
<h3>Chuẩn bị dữ liệu<a class="anchor" aria-label="anchor" href="#chu%E1%BA%A9n-b%E1%BB%8B-d%E1%BB%AF-li%E1%BB%87u-1"><i class="fas fa-link"></i></a>
</h3>
<p>Chúng ta bắt đầu bằng cách nhập bộ dữ liệu báo cáo về bệnh sốt rét hàng ngày từ nhiều cơ sở. Các báo cáo chứa dữu liệu về ngày, tỉnh, huyện và số trường hợp sốt rét. Xem chương <a href="data-used.html#data-used">Tải sách và dữ liệu</a> để biết thông tin về cách tải xuống các dữ liệu này. Dưới đây là 30 hàng đầu tiên:</p>
<div class="sourceCode" id="cb1630"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">facility_count_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"malaria_facility_count_data.rds"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-dc028cc360ae7d6ef1f4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-dc028cc360ae7d6ef1f4">{"x":{"filter":"none","data":[["Facility 1","Facility 2","Facility 3","Facility 4","Facility 5","Facility 6","Facility 6","Facility 5","Facility 5","Facility 5","Facility 7","Facility 8","Facility 9","Facility 10","Facility 11","Facility 12","Facility 13","Facility 14","Facility 15","Facility 16","Facility 17","Facility 18","Facility 19","Facility 19","Facility 20","Facility 21","Facility 19","Facility 22","Facility 23","Facility 23"],["2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-10","2020-08-10","2020-08-09","2020-08-08","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-11","2020-08-10","2020-08-11","2020-08-11","2020-08-09","2020-08-11","2020-08-11","2020-08-12"],["Spring","Bolo","Dingo","Bolo","Bolo","Dingo","Dingo","Bolo","Bolo","Bolo","Spring","Bolo","Spring","Bolo","Spring","Dingo","Bolo","Dingo","Barnard","Barnard","Barnard","Bolo","Bolo","Bolo","Barnard","Bolo","Bolo","Bolo","Dingo","Dingo"],[46,26,18,49,17,8,7,42,35,49,32,28,53,34,60,134,0,16,11,34,9,13,32,52,37,51,32,28,31,31]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>location_name<\/th>\n      <th>data_date<\/th>\n      <th>District<\/th>\n      <th>malaria_tot<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><div id="tổng-hợp-và-tóm-tắt" class="section level4 unnumbered">
<h4>Tổng hợp và tóm tắt<a class="anchor" aria-label="anchor" href="#t%E1%BB%95ng-h%E1%BB%A3p-v%C3%A0-t%C3%B3m-t%E1%BA%AFt"><i class="fas fa-link"></i></a>
</h4>
<p><strong>Mục tiêu của ví dụ này</strong> là chuyển đổi <em>tổng số</em> số ca bệnh sốt rét hàng ngày tại các cơ sở (xem trong tab trước) thành số liệu thống kê tóm tắt <em>hàng tuần</em> về hiệu suất báo cáo của cơ sở - trong trường hợp này là <em>tỷ lệ số ngày mỗi tuần mà cơ sở báo cáo bất kỳ dữ liệu nào</em>. Đối với ví dụ này, chúng ta sẽ chỉ hiển thị dữ liệu cho <strong>Spring District</strong>.</p>
<p>Để đạt được điều này, chúng ta sẽ thực hiện các bước quản lý dữ liệu sau:</p>
<ol style="list-style-type: decimal">
<li>Lọc dữ liệu phù hợp (theo địa điểm, ngày tháng)<br>
</li>
<li>Tạo cột tuần bằng cách sử dụng hàm <code>floor_date()</code> trong package <strong>lubridate</strong>
<ul>
<li>Hàm này trả về ngày bắt đầu trong tuần của một ngày cụ thể, sử dụng ngày bắt đầu được chỉ định của mỗi tuần (ví dụ: “Thứ Hai”)</li>
</ul>
</li>
<li>Dữ liệu được nhóm theo cột “location” và “week” để tạo ra các đơn vị phân tích “facility-week”<br>
</li>
<li>Hàm <code>summarise()</code> tạo các cột mới để trình bày thống kê tóm tắt cho từng nhóm cơ sở theo tuần (facility-week):
<ul>
<li>Số ngày mỗi tuần (7 - một giá trị không đổi)<br>
</li>
<li>Số lượng báo cáo nhận được từ cơ sở-tuần (có thể nhiều hơn 7!)<br>
</li>
<li>Tổng số ca sốt rét do cơ sở báo cáo trong tuần (chỉ dành cho ai quan tâm)<br>
</li>
<li>Số ngày <em>duy nhất</em> trong mỗi cơ sở-tuần có dữ liệu được báo cáo<br>
</li>
<li>
<strong>Phần trăm trong số 7 ngày mỗi cơ sở-tuần mà dữ liệu được báo cáo</strong><br>
</li>
</ul>
</li>
<li>Data frame được kết hợp bằng hàm <code>right_join()</code> thành một danh sách hoàn chỉnh về tất cả các kết hợp cơ sở-tuần có thể có, để làm cho tập dữ liệu hoàn thiện. Ma trận của tất cả các kết hợp có thể có được tạo bằng cách áp dụng hàm <code>expand()</code> cho hai cột đó của data frame giống như tại thời điểm đó trong chuỗi pipe (được biểu thị bằng <code>.</code>). Vì sử dụng hàm <code>right_join()</code>, nên tất cả các hàng trong data frame <code>expand()</code> mở rộng được giữ lại và được thêm vào <code>agg_weeks</code> nếu cần. Các hàng mới này xuất hiện với các giá trị tóm tắt <code>NA</code> (missing).</li>
</ol>
<p>Dưới đây là từng bước thực hiện:</p>
<div class="sourceCode" id="cb1631"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create weekly summary dataset</span>
<span class="va">agg_weeks</span> <span class="op">&lt;-</span> <span class="va">facility_count_data</span> <span class="op">%&gt;%</span> 
  
  <span class="co"># filter the data as appropriate</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span>
    <span class="va">District</span> <span class="op">==</span> <span class="st">"Spring"</span>,
    <span class="va">data_date</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-08-01"</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>Bây giờ tập dữ liệu có số lượng hàng tính theo agg_week <code><a href="https://rdrr.io/r/base/nrow.html">nrow(agg_weeks)</a></code>, trong khi trước được tính theo facility_count_data <code><a href="https://rdrr.io/r/base/nrow.html">nrow(facility_count_data)</a></code>.</p>
<p>Tiếp theo, chúng ta tạo cột <code>tuần</code> để phản ánh ngày bắt đầu trong tuần cho mỗi bản ghi. Thực hiện điều này với hàm <code>floor_date ()</code> trong package <strong>lubridate</strong>, giúp thiết lập theo “tuần” và các tuần sẽ bắt đầu vào Thứ Hai (ngày 1 trong tuần - Chủ Nhật sẽ là 7). Các hàng đầu tiên được hiển thị như bên dưới.</p>
<div class="sourceCode" id="cb1632"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">agg_weeks</span> <span class="op">&lt;-</span> <span class="va">agg_weeks</span> <span class="op">%&gt;%</span> 
  <span class="co"># Create week column from data_date</span>
  <span class="fu">mutate</span><span class="op">(</span>
    week <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span><span class="op">(</span>                     <span class="co"># create new column of weeks</span>
      <span class="va">data_date</span>,                                      <span class="co"># date column</span>
      unit <span class="op">=</span> <span class="st">"week"</span>,                                  <span class="co"># give start of the week</span>
      week_start <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>                                <span class="co"># weeks to start on Mondays </span></code></pre></div>
<p>Cột tuần mới này có thể được nhìn thấy ở ngoài cùng bên phải của data frame được tạo ra:</p>
<div id="htmlwidget-681c29f32cc261e94607" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-681c29f32cc261e94607">{"x":{"filter":"none","data":[["Facility 9","Facility 9","Facility 9","Facility 9","Facility 9","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 51","Facility 51","Facility 51","Facility 56","Facility 7","Facility 7","Facility 7","Facility 11","Facility 35","Facility 35","Facility 28","Facility 28","Facility 28","Facility 28"],["2020-07-31","2020-07-30","2020-07-29","2020-07-28","2020-07-27","2020-07-31","2020-07-30","2020-07-29","2020-07-28","2020-07-27","2020-07-26","2020-07-25","2020-07-24","2020-07-23","2020-07-22","2020-07-21","2020-07-30","2020-07-29","2020-07-28","2020-06-25","2020-07-31","2020-07-30","2020-07-29","2020-07-31","2020-07-30","2020-07-29","2020-07-30","2020-07-29","2020-07-28","2020-07-27"],["Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring"],[13,14,74,75,91,80,39,44,44,43,28,41,61,40,33,66,32,32,32,200,0,0,21,21,43,179,1,35,31,45],["2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-20","2020-07-20","2020-07-20","2020-07-20","2020-07-20","2020-07-20","2020-07-27","2020-07-27","2020-07-27","2020-06-22","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27","2020-07-27"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>location_name<\/th>\n      <th>data_date<\/th>\n      <th>District<\/th>\n      <th>malaria_tot<\/th>\n      <th>week<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Bây giờ chúng ta nhóm dữ liệu thành các cơ sở-tuần và tóm tắt chúng để tạo ra số liệu thống kê cho mỗi cơ sở-tuần. Xem thêm chương <a href="tables-descriptive.html#tables-descriptive">Bảng mô tả</a> để biết các mẹo. Bản thân việc nhóm sẽ không làm thay đổi data frame, nhưng nó ảnh hưởng đến cách các thống kê tóm tắt tiếp theo được tính toán.</p>
<p>Các hàng đầu tiên được hiển thị bên dưới. Lưu ý cách các cột đã thay đổi hoàn toàn để phản ánh thống kê tóm tắt mong muốn. Mỗi hàng phản ánh một cơ sở-tuần.</p>
<div class="sourceCode" id="cb1633"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">agg_weeks</span> <span class="op">&lt;-</span> <span class="va">agg_weeks</span> <span class="op">%&gt;%</span>   

  <span class="co"># Group into facility-weeks</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">location_name</span>, <span class="va">week</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="co"># Create summary statistics columns on the grouped data</span>
  <span class="fu">summarize</span><span class="op">(</span>
    n_days          <span class="op">=</span> <span class="fl">7</span>,                                          <span class="co"># 7 days per week           </span>
    n_reports       <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,                                 <span class="co"># number of reports received per week (could be &gt;7)</span>
    malaria_tot     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">malaria_tot</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,                <span class="co"># total malaria cases reported</span>
    n_days_reported <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data_date</span><span class="op">)</span><span class="op">)</span>,                  <span class="co"># number of unique days reporting per week</span>
    p_days_reported <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="va">n_days_reported</span> <span class="op">/</span> <span class="va">n_days</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>      <span class="co"># percent of days reporting</span></code></pre></div>
<div id="htmlwidget-e94b634f742451c807d9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e94b634f742451c807d9">{"x":{"filter":"none","data":[["Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 11","Facility 11","Facility 11","Facility 11","Facility 11","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28"],["2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-05-11","2020-05-18","2020-05-25","2020-06-01","2020-06-08","2020-06-15","2020-06-22","2020-06-29"],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[2,7,7,7,7,7,7,4,2,8,6,2,3,1,5,2,7,6,5,7,6,5,2,7,7,7,7,7,9,7],[0,0,0,101,402,570,378,131,354,853,502,317,245,0,0,0,17,147,136,118,88,86,26,216,155,120,319,256,475,352],[2,7,7,7,7,7,7,4,2,7,6,2,3,1,5,2,5,6,5,7,6,5,2,7,7,7,7,7,7,7],[29,100,100,100,100,100,100,57,29,100,86,29,43,14,71,29,71,86,71,100,86,71,29,100,100,100,100,100,100,100]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>location_name<\/th>\n      <th>week<\/th>\n      <th>n_days<\/th>\n      <th>n_reports<\/th>\n      <th>malaria_tot<\/th>\n      <th>n_days_reported<\/th>\n      <th>p_days_reported<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Cuối cùng, chúng ta chạy lệnh bên dưới để đảm bảo rằng TẤT CẢ các cơ sở-tuần có thể có trong dữ liệu, ngay cả khi chúng bị missing trước đó.</p>
<p>Chúng ta đang sử dụng hàm <code>right_join()</code> trên chính nó (tập dữ liệu được thể hiện bởi dấu “.”) nhưng đã được mở rộng để bao gồm tất cả các kết hợp có thể có của các cột <code>week</code> và <code>location_name</code>. Xem tài liệu về hàm <code>expand()</code> trong chương <a href="pivoting.html#pivoting">Xoay trục dữ liệu</a>. Trước khi chạy đoạn code này, tập dữ liệu cần chứa <code><a href="https://rdrr.io/r/base/nrow.html">nrow(agg_weeks)</a></code> hàng.</p>
<div class="sourceCode" id="cb1634"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create data frame of every possible facility-week</span>
<span class="va">expanded_weeks</span> <span class="op">&lt;-</span> <span class="va">agg_weeks</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>         <span class="co"># convert date to a factor so expand() works correctly</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">expand</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">week</span>, <span class="va">location_name</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># expand data frame to include all possible facility-week combinations</span>
                                             <span class="co"># note: "." represents the dataset at that moment in the pipe chain</span>
  <span class="fu">mutate</span><span class="op">(</span>week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span><span class="op">)</span>               <span class="co"># re-convert week to class Date so the subsequent right_join works</span></code></pre></div>
<p>Đây là <code>expanded_weeks</code>:</p>
<div id="htmlwidget-f3e0004beaf074325d88" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f3e0004beaf074325d88">{"x":{"filter":"none","data":[["2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-06-01","2020-05-11","2020-05-18","2020-05-25"],["Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 1","Facility 11","Facility 11","Facility 11","Facility 11","Facility 11","Facility 11","Facility 11","Facility 11","Facility 11","Facility 11","Facility 11","Facility 11","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 27","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 28","Facility 32","Facility 32","Facility 32","Facility 32","Facility 32","Facility 32","Facility 32","Facility 32","Facility 32","Facility 32","Facility 32","Facility 32","Facility 35","Facility 35","Facility 35","Facility 35","Facility 35","Facility 35","Facility 35","Facility 35","Facility 35","Facility 35","Facility 35","Facility 35","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 39","Facility 50","Facility 50","Facility 50","Facility 50","Facility 50","Facility 50","Facility 50","Facility 50","Facility 50","Facility 50","Facility 50","Facility 50","Facility 51","Facility 51","Facility 51","Facility 51","Facility 51","Facility 51","Facility 51","Facility 51","Facility 51","Facility 51","Facility 51","Facility 51","Facility 56","Facility 56","Facility 56","Facility 56","Facility 56","Facility 56","Facility 56","Facility 56","Facility 56","Facility 56","Facility 56","Facility 56","Facility 58","Facility 58","Facility 58","Facility 58","Facility 58","Facility 58","Facility 58","Facility 58","Facility 58","Facility 58","Facility 58","Facility 58","Facility 59","Facility 59","Facility 59","Facility 59","Facility 59","Facility 59","Facility 59","Facility 59","Facility 59","Facility 59","Facility 59","Facility 59","Facility 65","Facility 65","Facility 65","Facility 65","Facility 65","Facility 65","Facility 65","Facility 65","Facility 65","Facility 65","Facility 65","Facility 65","Facility 7","Facility 7","Facility 7","Facility 7","Facility 7","Facility 7","Facility 7","Facility 7","Facility 7","Facility 7","Facility 7","Facility 7","Facility 9","Facility 9","Facility 9","Facility 9","Facility 9","Facility 9","Facility 9","Facility 9","Facility 9","Facility 9","Facility 9","Facility 9"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>week<\/th>\n      <th>location_name<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>TRước khi chạy dòng lệnh này, <code>agg_weeks</code> bao gồm <code><a href="https://rdrr.io/r/base/nrow.html">nrow(agg_weeks)</a></code> hàng.</p>
<div class="sourceCode" id="cb1635"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use a right-join with the expanded facility-week list to fill-in the missing gaps in the data</span>
<span class="va">agg_weeks</span> <span class="op">&lt;-</span> <span class="va">agg_weeks</span> <span class="op">%&gt;%</span>      
  <span class="fu">right_join</span><span class="op">(</span><span class="va">expanded_weeks</span><span class="op">)</span> <span class="op">%&gt;%</span>                            <span class="co"># Ensure every possible facility-week combination appears in the data</span>
  <span class="fu">mutate</span><span class="op">(</span>p_days_reported <span class="op">=</span> <span class="fu">replace_na</span><span class="op">(</span><span class="va">p_days_reported</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>  <span class="co"># convert missing values to 0                           </span></code></pre></div>
<pre><code>## Joining, by = c("location_name", "week")</code></pre>
<p>Sau khi chạy dòng lệnh này, <code>agg_weeks</code> vẫn bao gồm <code><a href="https://rdrr.io/r/base/nrow.html">nrow(agg_weeks)</a></code> hàng.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="tạo-biểu-đồ-nhiệt-1" class="section level3 unnumbered">
<h3>Tạo biểu đồ nhiệt<a class="anchor" aria-label="anchor" href="#t%E1%BA%A1o-bi%E1%BB%83u-%C4%91%E1%BB%93-nhi%E1%BB%87t-1"><i class="fas fa-link"></i></a>
</h3>
<p>Hàm <code>ggplot()</code> được thực hiện bằng cách sử dụng hàm <code>geom_tile()</code> từ package <strong>ggplot2</strong>:</p>
<ul>
<li>Các tuần trên trục x được chuyển đổi thành ngày tháng, cho phép sử dụng <code>scale_x_date()</code><br>
</li>
<li>
<code>location_name</code> trên trục y sẽ hiển thị tất cả các tên cơ sở</li>
<li>
<code>fill</code> được gán cho <code>p_days_reported</code>, hiệu suất cho cơ sở-tuần đó (dạng số)</li>
<li>
<code>scale_fill_gradient()</code> được sử dụng để tô màu cho biến dạng số, cụ thể màu sắc gồm cao, thấp và <code>NA</code><br>
</li>
<li>
<code>scale_x_date()</code> được sử dụng trên trục x, chỉ định các nhãn 2 tuần một lần và định dạng của chúng<br>
</li>
<li>Các chủ đề và nhãn hiển thị có thể được điều chỉnh khi cần thiết</li>
</ul>
<!-- ======================================================= -->
</div>
<div id="cơ-bản" class="section level3 unnumbered">
<h3>Cơ bản<a class="anchor" aria-label="anchor" href="#c%C6%A1-b%E1%BA%A3n"><i class="fas fa-link"></i></a>
</h3>
<p>Biểu đồ nhiệt cơ bản sẽ được tạo như bên dưới, sử dụng màu, thang đo, v.v mặc định. Như đã giải thích ở trên, trong <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> của hàm <code>geom_tile()</code>, bạn phải cung cấp cột trục x, cột trục y, <strong>và</strong> một cột cho <code>fill =</code>. Phần tô là giá trị số thể hiện dưới dạng màu ô.</p>
<div class="sourceCode" id="cb1637"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">agg_weeks</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_tile</span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">week</span>,
        y <span class="op">=</span> <span class="va">location_name</span>,
        fill <span class="op">=</span> <span class="va">p_days_reported</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-1256-1.png" width="672"></div>
</div>
<div id="làm-sạch-biểu-đồ-nhiệt" class="section level3 unnumbered">
<h3>Làm sạch biểu đồ nhiệt<a class="anchor" aria-label="anchor" href="#l%C3%A0m-s%E1%BA%A1ch-bi%E1%BB%83u-%C4%91%E1%BB%93-nhi%E1%BB%87t"><i class="fas fa-link"></i></a>
</h3>
<p>Chúng ta có thể làm cho biểu đồ này trông đẹp hơn bằng cách thêm các hàm <strong>ggplot2</strong> bổ sung, như được hiển thị bên dưới. Xem thêm chương <a href="ggplot-tips.html#ggplot-tips">Các tips với ggplot</a> để biết thêm chi tiết.</p>
<div class="sourceCode" id="cb1638"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">agg_weeks</span><span class="op">)</span><span class="op">+</span> 
  
  <span class="co"># show data as tiles</span>
  <span class="fu">geom_tile</span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">week</span>,
        y <span class="op">=</span> <span class="va">location_name</span>,
        fill <span class="op">=</span> <span class="va">p_days_reported</span><span class="op">)</span>,      
    color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">+</span>                 <span class="co"># white gridlines</span>
  
  <span class="fu">scale_fill_gradient</span><span class="op">(</span>
    low <span class="op">=</span> <span class="st">"orange"</span>,
    high <span class="op">=</span> <span class="st">"darkgreen"</span>,
    na.value <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span><span class="op">+</span>
  
  <span class="co"># date axis</span>
  <span class="fu">scale_x_date</span><span class="op">(</span>
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,             <span class="co"># remove extra space on sides</span>
    date_breaks <span class="op">=</span> <span class="st">"2 weeks"</span>,     <span class="co"># labels every 2 weeks</span>
    date_labels <span class="op">=</span> <span class="st">"%d\n%b"</span><span class="op">)</span><span class="op">+</span>     <span class="co"># format is day over month (\n in newline)</span>
  
  <span class="co"># aesthetic themes</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                                  <span class="co"># simplify background</span>
  
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
    legend.text  <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
    legend.key.height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"cm"</span><span class="op">)</span>,           <span class="co"># height of legend key</span>
    legend.key.width  <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="st">"cm"</span><span class="op">)</span>,         <span class="co"># width of legend key</span>
    
    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,              <span class="co"># axis text size</span>
    axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>vjust<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>,            <span class="co"># axis text alignment</span>
    axis.ticks <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>,               
    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,  <span class="co"># axis title size and bold</span>
    
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>,size<span class="op">=</span><span class="fl">14</span>,face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,  <span class="co"># title right-aligned, large, bold</span>
    plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>  <span class="co"># caption right-aligned and italic</span>
    <span class="op">)</span><span class="op">+</span>
  
  <span class="co"># plot labels</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Week"</span>,
       y <span class="op">=</span> <span class="st">"Facility name"</span>,
       fill <span class="op">=</span> <span class="st">"Reporting\nperformance (%)"</span>,           <span class="co"># legend title, because legend shows fill</span>
       title <span class="op">=</span> <span class="st">"Percent of days per week that facility reported data"</span>,
       subtitle <span class="op">=</span> <span class="st">"District health facilities, May-July 2020"</span>,
       caption <span class="op">=</span> <span class="st">"7-day weeks beginning on Mondays."</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-1257-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
<div id="sắp-xếp-thứ-tự-trục-y" class="section level3 unnumbered">
<h3>Sắp xếp thứ tự trục y<a class="anchor" aria-label="anchor" href="#s%E1%BA%AFp-x%E1%BA%BFp-th%E1%BB%A9-t%E1%BB%B1-tr%E1%BB%A5c-y"><i class="fas fa-link"></i></a>
</h3>
<p>Hiện tại, các cơ sở được sắp xếp theo thứ tự “theo bảng chữ cái” từ dưới lên trên. Nếu bạn muốn điều chỉnh thứ tự các cơ sở trục y, hãy chuyển đổi chúng thành factor thứ bậc và cung cấp thứ tự. Xem thêm chương <a href="factors.html#factors">Factors</a> để biết các mẹo để thực hiện điều này.</p>
<p>Vì có rất nhiều cơ sở và chúng ta không muốn viết hết chúng ra, chúng ta sẽ thử một cách tiếp cận khác - sắp xếp thứ tự các cơ sở trong data frame và sử dụng cột tên kết quả làm thứ tự của factor. Bên dưới, cột <code>location_name</code> được chuyển đổi thành một factor và thứ tự của các cấp của nó được đặt dựa trên tổng số ngày báo cáo do cơ sở nộp trong toàn bộ khoảng thời gian.</p>
<p>Để làm điều này, chúng ta tạo một data frame đại diện cho tổng số báo cáo cho mỗi cơ sở, được sắp xếp theo thứ tự tăng dần. Chúng ta có thể sử dụng vectơ này để sắp xếp các mức thứ tự trong biểu đồ.</p>
<div class="sourceCode" id="cb1639"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">facility_order</span> <span class="op">&lt;-</span> <span class="va">agg_weeks</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">location_name</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span><span class="op">(</span>tot_reports <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n_days_reported</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">tot_reports</span><span class="op">)</span> <span class="co"># ascending order</span></code></pre></div>
<p>Xem data frame bên dưới:</p>
<div id="htmlwidget-283428e5ccb1f31b9817" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-283428e5ccb1f31b9817">{"x":{"filter":"none","data":[["Facility 56","Facility 65","Facility 11","Facility 39","Facility 59","Facility 27","Facility 51","Facility 32","Facility 7","Facility 1","Facility 9","Facility 35","Facility 50","Facility 58","Facility 28"],[1,6,20,33,35,42,42,43,44,48,50,52,53,55,77]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>location_name<\/th>\n      <th>tot_reports<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Bây giờ, hãy sử dụng một cột từ data frame bên trên (<code>facility_order$location_name</code>) để trở thành thứ bậc factors của biến <code>location_name</code> trong data frame <code>agg_weeks</code>:</p>
<div class="sourceCode" id="cb1640"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load package </span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">forcats</span><span class="op">)</span>

<span class="co"># create factor and define levels manually</span>
<span class="va">agg_weeks</span> <span class="op">&lt;-</span> <span class="va">agg_weeks</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>location_name <span class="op">=</span> <span class="fu">fct_relevel</span><span class="op">(</span>
    <span class="va">location_name</span>, <span class="va">facility_order</span><span class="op">$</span><span class="va">location_name</span><span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<p>Và bây giờ dữ liệu được vẽ lại, với <code>location_name</code> trở thành một factor có thứ tự:</p>
<div class="sourceCode" id="cb1641"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">agg_weeks</span><span class="op">)</span><span class="op">+</span> 
  
  <span class="co"># show data as tiles</span>
  <span class="fu">geom_tile</span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">week</span>,
        y <span class="op">=</span> <span class="va">location_name</span>,
        fill <span class="op">=</span> <span class="va">p_days_reported</span><span class="op">)</span>,      
    color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">+</span>                 <span class="co"># white gridlines</span>
  
  <span class="fu">scale_fill_gradient</span><span class="op">(</span>
    low <span class="op">=</span> <span class="st">"orange"</span>,
    high <span class="op">=</span> <span class="st">"darkgreen"</span>,
    na.value <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span><span class="op">+</span>
  
  <span class="co"># date axis</span>
  <span class="fu">scale_x_date</span><span class="op">(</span>
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,             <span class="co"># remove extra space on sides</span>
    date_breaks <span class="op">=</span> <span class="st">"2 weeks"</span>,     <span class="co"># labels every 2 weeks</span>
    date_labels <span class="op">=</span> <span class="st">"%d\n%b"</span><span class="op">)</span><span class="op">+</span>     <span class="co"># format is day over month (\n in newline)</span>
  
  <span class="co"># aesthetic themes</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                                  <span class="co"># simplify background</span>
  
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
    legend.text  <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
    legend.key.height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"cm"</span><span class="op">)</span>,           <span class="co"># height of legend key</span>
    legend.key.width  <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="st">"cm"</span><span class="op">)</span>,         <span class="co"># width of legend key</span>
    
    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,              <span class="co"># axis text size</span>
    axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>vjust<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>,            <span class="co"># axis text alignment</span>
    axis.ticks <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>,               
    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,  <span class="co"># axis title size and bold</span>
    
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>,size<span class="op">=</span><span class="fl">14</span>,face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,  <span class="co"># title right-aligned, large, bold</span>
    plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>  <span class="co"># caption right-aligned and italic</span>
    <span class="op">)</span><span class="op">+</span>
  
  <span class="co"># plot labels</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Week"</span>,
       y <span class="op">=</span> <span class="st">"Facility name"</span>,
       fill <span class="op">=</span> <span class="st">"Reporting\nperformance (%)"</span>,           <span class="co"># legend title, because legend shows fill</span>
       title <span class="op">=</span> <span class="st">"Percent of days per week that facility reported data"</span>,
       subtitle <span class="op">=</span> <span class="st">"District health facilities, May-July 2020"</span>,
       caption <span class="op">=</span> <span class="st">"7-day weeks beginning on Mondays."</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-1261-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
<div id="biểu-diễn-các-giá-trị" class="section level3 unnumbered">
<h3>Biểu diễn các giá trị<a class="anchor" aria-label="anchor" href="#bi%E1%BB%83u-di%E1%BB%85n-c%C3%A1c-gi%C3%A1-tr%E1%BB%8B"><i class="fas fa-link"></i></a>
</h3>
<p>Bạn có thể thêm lớp văn bản <code>geom_text()</code> lên phía trên các ô, để hiển thị số lượng thực của mỗi ô. Hãy lưu ý rằng điều này có thể trông không đẹp nếu bạn có nhiều ô nhỏ!</p>
<p>Đoạn code sau đã được thêm vào: <code>geom_text(aes(label = p_days_reported))</code>. Điều này giúp thêm văn bản vào từng ô. Văn bản được hiển thị là giá trị được gán cho đối số <code>label =</code>, trong trường hợp này đã được đặt thành cùng một cột số <code>p_days_reported</code> cũng được sử dụng để tạo gradient màu.</p>
<div class="sourceCode" id="cb1642"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">agg_weeks</span><span class="op">)</span><span class="op">+</span> 
  
  <span class="co"># show data as tiles</span>
  <span class="fu">geom_tile</span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">week</span>,
        y <span class="op">=</span> <span class="va">location_name</span>,
        fill <span class="op">=</span> <span class="va">p_days_reported</span><span class="op">)</span>,      
    color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">+</span>                 <span class="co"># white gridlines</span>
  
  <span class="co"># text</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">week</span>,
      y <span class="op">=</span> <span class="va">location_name</span>,
      label <span class="op">=</span> <span class="va">p_days_reported</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>      <span class="co"># add text on top of tile</span>
  
  <span class="co"># fill scale</span>
  <span class="fu">scale_fill_gradient</span><span class="op">(</span>
    low <span class="op">=</span> <span class="st">"orange"</span>,
    high <span class="op">=</span> <span class="st">"darkgreen"</span>,
    na.value <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span><span class="op">+</span>
  
  <span class="co"># date axis</span>
  <span class="fu">scale_x_date</span><span class="op">(</span>
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,             <span class="co"># remove extra space on sides</span>
    date_breaks <span class="op">=</span> <span class="st">"2 weeks"</span>,     <span class="co"># labels every 2 weeks</span>
    date_labels <span class="op">=</span> <span class="st">"%d\n%b"</span><span class="op">)</span><span class="op">+</span>     <span class="co"># format is day over month (\n in newline)</span>
  
  <span class="co"># aesthetic themes</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                                    <span class="co"># simplify background</span>
  
  <span class="fu">theme</span><span class="op">(</span>
    legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
    legend.text  <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
    legend.key.height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"cm"</span><span class="op">)</span>,           <span class="co"># height of legend key</span>
    legend.key.width  <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="st">"cm"</span><span class="op">)</span>,         <span class="co"># width of legend key</span>
    
    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,              <span class="co"># axis text size</span>
    axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>vjust<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>,            <span class="co"># axis text alignment</span>
    axis.ticks <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>,               
    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,  <span class="co"># axis title size and bold</span>
    
    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>,size<span class="op">=</span><span class="fl">14</span>,face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,  <span class="co"># title right-aligned, large, bold</span>
    plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>  <span class="co"># caption right-aligned and italic</span>
    <span class="op">)</span><span class="op">+</span>
  
  <span class="co"># plot labels</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Week"</span>,
       y <span class="op">=</span> <span class="st">"Facility name"</span>,
       fill <span class="op">=</span> <span class="st">"Reporting\nperformance (%)"</span>,           <span class="co"># legend title, because legend shows fill</span>
       title <span class="op">=</span> <span class="st">"Percent of days per week that facility reported data"</span>,
       subtitle <span class="op">=</span> <span class="st">"District health facilities, May-July 2020"</span>,
       caption <span class="op">=</span> <span class="st">"7-day weeks beginning on Mondays."</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-1262-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="nguồn-9" class="section level2" number="34.4">
<h2>
<span class="header-section-number">34.4</span> Nguồn<a class="anchor" aria-label="anchor" href="#ngu%E1%BB%93n-9"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient()</a></p>
<p><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">R graph gallery - heatmap</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="age-pyramid.html"><span class="header-section-number">33</span> Tháp dân số và thang đo Likert</a></div>
<div class="next"><a href="diagrams.html"><span class="header-section-number">35</span> Sơ đồ và biểu đồ</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#heatmaps"><span class="header-section-number">34</span> Biểu đồ nhiệt</a></li>
<li>
<a class="nav-link" href="#chu%E1%BA%A9n-b%E1%BB%8B-26"><span class="header-section-number">34.1</span> Chuẩn bị</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#g%E1%BB%8Di-packages-11">Gọi packages</a></li></ul>
</li>
<li>
<a class="nav-link" href="#ma-tr%E1%BA%ADn-l%C3%A2y-truy%E1%BB%81n-1"><span class="header-section-number">34.2</span> Ma trận lây truyền</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#chu%E1%BA%A9n-b%E1%BB%8B-d%E1%BB%AF-li%E1%BB%87u">Chuẩn bị dữ liệu</a></li>
<li><a class="nav-link" href="#t%E1%BA%A1o-bi%E1%BB%83u-%C4%91%E1%BB%93-nhi%E1%BB%87t">Tạo biểu đồ nhiệt</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#c%C3%A1c-ch%E1%BB%89-s%E1%BB%91-b%C3%A1o-c%C3%A1o-theo-th%E1%BB%9Di-gian"><span class="header-section-number">34.3</span> Các chỉ số báo cáo theo thời gian</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#chu%E1%BA%A9n-b%E1%BB%8B-d%E1%BB%AF-li%E1%BB%87u-1">Chuẩn bị dữ liệu</a></li>
<li><a class="nav-link" href="#t%E1%BA%A1o-bi%E1%BB%83u-%C4%91%E1%BB%93-nhi%E1%BB%87t-1">Tạo biểu đồ nhiệt</a></li>
<li><a class="nav-link" href="#c%C6%A1-b%E1%BA%A3n">Cơ bản</a></li>
<li><a class="nav-link" href="#l%C3%A0m-s%E1%BA%A1ch-bi%E1%BB%83u-%C4%91%E1%BB%93-nhi%E1%BB%87t">Làm sạch biểu đồ nhiệt</a></li>
<li><a class="nav-link" href="#s%E1%BA%AFp-x%E1%BA%BFp-th%E1%BB%A9-t%E1%BB%B1-tr%E1%BB%A5c-y">Sắp xếp thứ tự trục y</a></li>
<li><a class="nav-link" href="#bi%E1%BB%83u-di%E1%BB%85n-c%C3%A1c-gi%C3%A1-tr%E1%BB%8B">Biểu diễn các giá trị</a></li>
</ul>
</li>
<li><a class="nav-link" href="#ngu%E1%BB%93n-9"><span class="header-section-number">34.4</span> Nguồn</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Cẩm nang dịch tễ học với R</strong>" was written by the handbook team. It was last built on 2021-11-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
